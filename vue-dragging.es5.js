!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueDragging=e()}(this,function(){"use strict";var t={listeners:{},$on:function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},$once:function(t,e){var n=this;this.$on(t,function i(){n.$off(t,i);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];e.apply(n,r)})},$off:function(t,e){var n=this.listeners[t];this.listeners[t]=e&&n?this.listeners[t].filter(function(t){return t!==e}):[]},$emit:function(t,e){var n=this.listeners[t];n&&n.length>0&&n.forEach(function(t){t(e)})}},e={on:function(t,e,n){t.addEventListener(e,n)},off:function(t,e,n){t.removeEventListener(e,n)},addClass:function(t,e){if(arguments.length<2)t.classList.add(e);else for(var n=1,i=arguments.length;n<i;n++)t.classList.add(arguments[n])},removeClass:function(t,e){if(arguments.length<2)t.classList.remove(e);else for(var n=1,i=arguments.length;n<i;n++)t.classList.remove(arguments[n])}};return function(n){var i="1"===n.version.split(".")[0],o=-1,r=null,s=[],u=[],f=document.createElement("img"),l=document.getElementById("app");function a(t,e,n){t.style.left=e-40+"px",t.style.top=n-40+"px"}function d(t){t.stopPropagation();var n=function(t){if(t)for(;t.parentNode;){if(t.getAttribute&&t.getAttribute("drag_group"))return t;t=t.parentNode}}(t.target),i=n.getAttribute("drag_key"),r=s[i],l=t.touches[0];if(r&&(o=i,a(f=document.querySelector(".vue_dnd_img"),l.clientX,l.clientY),f.src=r,e.removeClass(f,"fn-hide")),u.length!==s.length)for(var d=n.parentNode.childNodes,c=0;c<d.length;c++){var g=d[c].getBoundingClientRect();u.push(g)}}function c(t){t.stopPropagation(),t.preventDefault(),r=t.touches[0],a(f,r.clientX,r.clientY)}function g(){if(o>-1&&r){var t=u.findIndex(function(t){return t.left<=r.clientX&&r.clientX<=t.left+t.width&&t.top<=r.clientY&&r.clientY<=t.top+t.height});s&&s.length&&t>-1&&function(t,e,o){var r=t[o];i?(t.$set(o,t[e]),t.$set(e,r)):(n.set(t,o,t[e]),n.set(t,e,r))}(s,o,t)}r=null,o=-1,f.src="",e.addClass(f,"fn-hide")}function h(t,n,o){var r=n.value.list,u=i?n.value.key:o.key;r&&s!==r&&(s=r),t.setAttribute("drag_group",n.value.group),t.setAttribute("drag_key",u),e.on(t,"touchstart",d),e.on(t,"touchmove",c),e.on(t,"touchend",g)}function p(t){e.off(t,"touchstart",d),e.off(t,"touchmove",c),e.off(t,"touchend",g)}f.src="",e.addClass(f,"vue_dnd_img","fn-hide"),l.appendChild(f),f=document.querySelector(".vue_dnd_img"),n.prototype.$dragging=t,i?n.directive("dragging",{update:function(t,e){h(this.el,{modifiers:this.modifiers,arg:this.arg,value:t,oldValue:e})},unbind:function(t,e){p(this.el,(this.modifiers,this.arg,t||this.el.getAttribute("drag_group")))}}):n.directive("dragging",{bind:h,unbind:p})}});
